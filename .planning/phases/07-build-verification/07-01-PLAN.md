---
phase: 07-build-verification
plan: 01
type: execute
depends_on: []
files_modified: []
---

<objective>
Run full TypeScript compilation and component copying build to verify zero MPV integration errors remain.

Purpose: Confirm that all MPV/V5 integration cleanup from Phases 1-6 results in a successful build with zero TypeScript errors or missing file references.
Output: Successfully compiled dist/ directory with all TypeScript files and HTML templates, ready for development testing.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-preload-script-cleanup/06-01-SUMMARY.md
@.planning/codebase/STACK.md
@.planning/codebase/CONVENTIONS.md

**Prior phase context:**
- Phase 1-6 complete: All MPV integration files removed, UI cleaned, dependencies removed, main.ts and preload.ts verified clean
- Phase 5: main.ts verified clean with zero MPV references (no imports, no IPC handlers)
- Phase 6: preload.ts verified clean with zero MPV references (no imports, no injector setup)
- Phase 4: package.json cleaned of MPV dependencies

**Build system:**
- Build command: `npm run dist` = `tsc && node ./copyComponents.js`
- TypeScript strict mode enabled (`noUnusedLocals`, `noUnusedParameters`, `noImplicitReturns`)
- Output: dist/ directory with compiled JavaScript + HTML templates
- Component copying: copyComponents.js copies HTML templates from src/components/ to dist/components/

**Expected outcome:**
- TypeScript compilation should succeed with ZERO errors
- If errors occur: Missing imports or references to removed MPV files indicate incomplete cleanup
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run npm run dist build</name>
  <files>dist/</files>
  <action>Execute `npm run dist` to compile TypeScript and copy component templates. This runs `tsc` (TypeScript compiler) followed by `node ./copyComponents.js` (copies HTML templates). Capture full output including any errors or warnings. TypeScript strict mode will catch any remaining references to removed MPV files via unused imports or missing type definitions.</action>
  <verify>Command exits with code 0 (success), dist/ directory populated with compiled .js files</verify>
  <done>Build completes successfully with zero TypeScript errors, zero warnings about missing imports, dist/ directory contains main.js and all component files</done>
</task>

<task type="auto">
  <name>Task 2: Verify no MPV references in build output</name>
  <files>dist/</files>
  <action>Search compiled output for any remaining MPV references that might indicate missed cleanup. Run: `grep -ri "mpv\|native.*player" dist/ --exclude-dir=node_modules` (case-insensitive search). Exclude false positives like GPU flags ("native-gpu-memory-buffers") and Stremio's original player references ("Stremio's native Player"). Any matches to MpvManager, NativePlayerConfig, setupNativePlayerInjector indicate missed cleanup.</action>
  <verify>grep returns zero matches OR only false positives (GPU flags, Stremio original player comments)</verify>
  <done>No MPV integration references found in compiled dist/ output, confirming cleanup complete at build level</done>
</task>

<task type="auto">
  <name>Task 3: Verify component templates copied correctly</name>
  <files>dist/components/</files>
  <action>Verify copyComponents.js successfully copied all HTML templates to dist/components/. Check that dist/components/ directory exists and contains .html files. Run: `ls -la dist/components/ | head -20` to verify presence of component templates. The component system loads templates from dist/components/ at runtime, so missing templates would cause runtime errors.</action>
  <verify>dist/components/ directory exists with multiple .html files (mods-tab.html, plugin-item.html, etc.)</verify>
  <done>All component HTML templates present in dist/components/, confirming copyComponents.js executed successfully</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run dist` exits with code 0 (success)
- [ ] No TypeScript compilation errors
- [ ] No warnings about missing imports or unused variables
- [ ] dist/ directory populated with .js files
- [ ] dist/components/ directory contains HTML templates
- [ ] No MPV references in compiled dist/ output
</verification>

<success_criteria>

- All tasks completed
- Build succeeds with zero errors
- No MPV integration references in compiled output
- Component templates copied successfully
- Ready for Phase 7 Plan 2 (dev mode testing)
</success_criteria>

<output>
After completion, create `.planning/phases/07-build-verification/07-01-SUMMARY.md`:

# Phase 7 Plan 1: Build Verification Summary

**[Substantive one-liner - whether build succeeded or what errors were fixed]**

## Accomplishments

- [npm run dist outcome - success or errors fixed]
- [TypeScript compilation status]
- [Component template copying status]
- [MPV reference search results]

## Files Created/Modified

- `dist/` - Compiled output directory
- [Any files modified to fix build errors, or "None - build succeeded"]

## Decisions Made

[Build errors encountered and how resolved, or "None - build succeeded on first try"]

## Issues Encountered

[Build problems and resolutions, or "None"]

## Next Step

Ready for 07-02-PLAN.md (run npm run dev and verify original player loads content)
</output>
