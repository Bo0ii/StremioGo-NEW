---
phase: 01-investigation-mapping
plan: 02
type: execute
depends_on: ["01-01"]
files_modified: [.planning/phases/01-investigation-mapping/dependency-map.md, .planning/phases/01-investigation-mapping/removal-checklist.md]
---

<objective>
Analyze integration dependencies and create comprehensive removal checklist based on discovered integration points.

Purpose: Understand how MPV integration connects to the rest of the codebase to enable safe, complete removal.
Output: Dependency map showing integration touch points and prioritized removal checklist.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/STRUCTURE.md
@.planning/phases/01-investigation-mapping/01-01-SUMMARY.md
@.planning/phases/01-investigation-mapping/integration-points.md

**Integration points from Plan 01:**
Will reference the complete file list from integration-points.md

**Known integration layers:**
- Components: native-player-controls, native-player-injector
- Utilities: MpvManager, MpvBinaryManager, Anime4KProfiles
- Core: NativePlayerConfig
- UI: Plus Page native player subpage
- Dependencies: package.json entries
- Main/Preload: Initialization code in main.ts and preload.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Map integration dependencies</name>
  <files>.planning/phases/01-investigation-mapping/dependency-map.md</files>
  <action>Read each integration file identified in Plan 01 and analyze imports/exports to understand dependencies. Create dependency map showing: (1) What imports MPV code (main.ts, preload.ts, other files), (2) What MPV code imports (external dependencies, internal utilities), (3) Integration touch points (Plus Page UI, constants, IPC channels). Document in dependency-map.md with clear sections for each category. Include code snippet locations (file:line) for key integration points.</action>
  <verify>dependency-map.md created with complete dependency graph</verify>
  <done>All integration dependencies mapped with file/line references</done>
</task>

<task type="auto">
  <name>Task 2: Analyze Plus Page integration</name>
  <files>.planning/phases/01-investigation-mapping/dependency-map.md</files>
  <action>Read src/components/plus-page/plus-page.html and src/components/plus-page/plusPage.ts to identify exactly where native player UI is integrated. Document: (1) HTML elements for native player subpage, (2) TypeScript logic for native player toggle/config, (3) Event handlers and IPC calls related to native player, (4) CSS classes or IDs specific to native player UI. Append findings to dependency-map.md under "Plus Page Integration" section.</action>
  <verify>Plus Page integration points documented in dependency-map.md</verify>
  <done>Native player UI elements and logic identified with specific line numbers</done>
</task>

<task type="auto">
  <name>Task 3: Create prioritized removal checklist</name>
  <files>.planning/phases/01-investigation-mapping/removal-checklist.md</files>
  <action>Based on dependency-map.md, create removal-checklist.md with prioritized order for removal phases 2-8. For each phase in roadmap (Core File Removal, UI Cleanup, Dependencies, Main Process, Preload Script, Build Verification, Final Validation), list specific files/sections to remove, why this order is safe, and what to verify after removal. Include file paths and line number ranges where possible. Format as checklist with checkboxes for tracking during execution.</action>
  <verify>removal-checklist.md created with complete phase-by-phase plan</verify>
  <done>Removal checklist aligns with roadmap phases 2-8, includes all discovered integration points</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] dependency-map.md shows complete integration dependency graph
- [ ] Plus Page integration fully documented
- [ ] removal-checklist.md aligns with roadmap phases 2-8
- [ ] All integration points from 01-01 accounted for in checklist
</verification>

<success_criteria>

- All tasks completed
- dependency-map.md provides clear picture of integration architecture
- removal-checklist.md ready to guide phases 2-8
- No integration dependency overlooked
- Phase 1 complete, ready for Phase 2
</success_criteria>

<output>
After completion, create `.planning/phases/01-investigation-mapping/01-02-SUMMARY.md`:

# Phase 1 Plan 2: Dependency Mapping Summary

**[One-line summary of integration architecture discovered]**

## Accomplishments

- Mapped all MPV integration dependencies
- Analyzed Plus Page native player UI integration
- Created prioritized removal checklist for phases 2-8
- Identified [N] integration touch points across codebase

## Files Created/Modified

- `.planning/phases/01-investigation-mapping/dependency-map.md` - Integration dependency graph
- `.planning/phases/01-investigation-mapping/removal-checklist.md` - Prioritized removal plan

## Decisions Made

None - documentation phase only

## Issues Encountered

[Any dependency complexities or concerns for future phases]

## Next Phase Readiness

**Phase 2: Core File Removal** - Ready to begin
- removal-checklist.md provides exact files to remove
- Dependency map shows no critical dependencies on core MPV files
- Safe to proceed with file removal

**Concerns:**
[List any discovered concerns that affect Phase 2+]
</output>
